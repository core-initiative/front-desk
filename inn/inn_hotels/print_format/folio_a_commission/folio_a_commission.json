{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2024-03-06 11:23:10.060463",
 "custom_format": 1,
 "default_print_language": "ar",
 "disabled": 0,
 "doc_type": "Inn Folio",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "{% set company = frappe.get_doc(\"Global Defaults\").default_company %}\n{% set setting = frappe.get_doc(\"Inn Hotels Setting\") %}\n{% set address = setting.address %}\n{% set phone = setting.phone %}\n{% set customer = frappe.get_doc(\"Customer\", doc.customer_id) %}\n{% set accumulator1 = namespace(debit = 0.0) %}\n{% set accumulator2 = namespace(credit = 0.0) %}\n{% set accumulator3 = namespace(refund = 0.0) %}\n{% set room_charge = {} %}\n{% set package = {} %}\n\n{% set commission = namespace(commission = 0.0, remarks = '') %}\n{% set commission_transaction_type = setting.profit_sharing_transaction_type %}\n\n\n{% for row in doc.folio_transaction %}\n  {% if row.sub_folio == 'A' and row.is_void == 0 %}\n    {% if row.flag == 'Debit' %}\n      {% set accumulator1.debit = accumulator1.debit + row.amount %}\n    {% elif row.flag == 'Credit' %}\n      {% set accumulator2.credit = accumulator2.credit + row.amount %}\n    {% endif %}\n\n    {% if row.transaction_type == 'Room Charge' %}\n      {% set _ = room_charge.update({row.ftb_id: row.amount}) %}\n    {% elif row.transaction_type == 'Package' %}\n      {% set _ = package.update({row.ftb_id: row.amount}) %}\n    {% endif %}\n  {% endif %}\n{% endfor %}\n<div class=\"container\">\n    <div class=\"row\" style=\"text-align: center; margin-bottom: 20px;\">\n        <div class=\"col-xs-12\" style=\"display: flex; justify-content: space-between; align-items: center;\">\n            <!-- Left Side: Bold Text -->\n            <div style=\"flex: 1; text-align: left;\">\n                <h3 style=\"margin: 0; font-size: 24px; font-weight: bold;\">{{ company | upper }}</h3>\n                <p style=\"margin: 5px 0; font-size: 14px; font-weight: bold;\">{{ address }}</p>\n                <p style=\"margin: 5px 0; font-size: 14px; font-weight: bold;\">Phone: {{ phone }}</p>\n            </div>\n\n            <!-- Company Logo (Centered) -->\n            <div style=\"flex: 1; display: flex; justify-content: center; align-items: center;\">\n                <img \n                    src=\"{{ frappe.db.get_value('Company', doc.company, 'company_logo') or '' }}\" \n                    alt=\"Company Logo\" \n                    style=\"max-height: 95px; max-width: 100%; object-fit: contain;\" \n                />\n            </div>\n\n            <!-- Empty div to push the logo to the middle -->\n            <div style=\"flex: 1;\"></div>\n        </div>\n    </div>\n</div>\n\n<!-- Horizontal Line Separator -->\n<hr style=\"border: 0.5px solid black; width: 100%; margin: 10px 0;\">\n{% for row in doc.folio_transaction %}\n  {% if row.sub_folio == 'A' and row.is_void == 0 %}\n    {% if row.transaction_type != 'Room Charge' and row.transaction_type != 'Package'%}\n      {% if row.ftb_id in room_charge %}\n        {% set _ = room_charge.update({row.ftb_id: room_charge[row.ftb_id] + row.amount}) %}\n      {% elif row.ftb_id in package %}\n        {% set _ = package.update({row.ftb_id: package[row.ftb_id] + row.amount}) %}\n      {% endif %}\n    {% endif %}\n  {% endif %}\n{% endfor %}\n\n<div class= \"row\">\n  <div class= \"col-xs-4\">\n    <div class= \"col-xs-3\" style= \"padding-left:0px;\"><b>Customer:</b></div>\n    <div class= \"col-xs-9\">{{ doc.customer_id | upper }}</div>\n    <div class= \"col-xs-3\" style= \"padding-left:0px;\"><b>Type:</b></div>\n    <div class= \"col-xs-9\">{{ doc.type }}</div>\n    <div class= \"col-xs-3\" style= \"padding-left:0px;\"><b>Address:</b></div>\n    {% if customer.primary_address != None %}\n    <div class= \"col-xs-9\">{{ customer.primary_address }}</div>\n    {% else %}\n    <div class= \"col-xs-9\"></div>\n    {% endif%}\n    </div>\n    <div class= \"col-xs-8\">\n      <table class= \"table table-bordered\" style= \"margin-top:-1px;\">\n        <tr>\n          <th>Reservation</th>\n          <th>Check In</th>\n          <th>Check Out</th>\n          <th>Folio</th>\n          <th>Balance</th>\n        </tr>\n        <tr>\n          {% if doc.reservation_id != None %}\n            {% set reservation = frappe.get_doc(\"Inn Reservation\", doc.reservation_id) %}\n            <td>{{doc.reservation_id}}</td>\n            <td>{{(reservation.arrival|string)[:11]}}</td>\n            <td>{{(reservation.departure|string)[:11]}}</td>\n          {% else %}\n            <td></td>\n            <td>{{(doc.open|string)[:11]}}</td>\n            <td>{{doc.close}}</td>\n          {% endif %}\n          <td>{{doc.name}}</td>\n          <td>{{ frappe.format_value(accumulator2.credit-accumulator1.debit, {\"fieldtype\":\"Currency\"}) }}</td>\n        </tr>\n      </table>\n    </div>\n  </div>\n\n<div class= \"row\">\n  <div class= \"col-xs-12\">\n    <table class= \"table table-bordered\">\n      <tr>\n        <th class= \"col-xs-2\">Date</th>\n        <th class= \"col-xs-2\">Type</th>\n        <th class= \"col-xs-1\">Mode of Payment</th>\n        <th class= \"col-xs-3\">Description/Remark</th>\n        <th class= \"col-xs-2\">Debit</th>\n        <th class= \"col-xs-2\">Credit</th>\n      </tr>\n\n      {% for row in doc.folio_transaction %}\n        {% if row.sub_folio == 'A' and row.is_void == 0 %}\n        {% if row.transaction_type not in ['Room Charge Tax/Service', 'Breakfast Charge Tax/Service', 'Breakfast Charge', 'Package Tax'] %}\n            {% if row.transaction_type == commission_transaction_type %}\n                {% set commission.commission = commission.commission + row.amount %}\n                {% set commission.remarks = row.remarks %}\n            {% else %}\n                            <tr>\n              <td>{{row.audit_date}}</td>\n              <td>{{row.transaction_type}}</td>\n              {% if row.mode_of_payment != None %}\n                <td>{{row.mode_of_payment}}</td>\n              {% else %}\n                <td></td>\n              {% endif %}\n              <td>{{row.remark}}</td>\n\n              {% if row.flag == 'Debit' %}\n                <td class= \"text-right\">\n                  {% if row.transaction_type == 'Room Charge' %}\n                    {{ frappe.format_value(room_charge[row.ftb_id], {\"fieldtype\":\"Currency\"}) }}\n\t          {% elif row.transaction_type == 'Package' %}\n                    {{ frappe.format_value(package[row.ftb_id], {\"fieldtype\":\"Currency\"}) }}\n                  {% else %}\n                    {{ frappe.format_value(row.amount, {\"fieldtype\":\"Currency\"}) }}\n\t          {% endif %}\n                </td>\n                <td class= \"text-center\">-</td> \n              {% elif row.flag == 'Credit' %}\n                <td class= \"text-center\">-</td>\n                <td class= \"text-right\">\n                  {{ frappe.format_value(row.amount, {\"fieldtype\":\"Currency\"}) }}\n                </td>\n              {% endif %}\n\n              {% if row.transaction_type == 'Refund' %}\n                {% set accumulator3.refund = accumulator3.refund + row.amount %}\n              {% endif %}\n            </tr>\n            {% endif %}\n          {% endif %}\n        {% endif %}\n      {% endfor %}\n\n      <tr>\n        <td colspan=\"4\" class= \"text-right\"><b>Total</b></td>\n        <td class= \"text-right\">\n          <b>{{ frappe.format_value(accumulator1.debit, {\"fieldtype\":\"Currency\"}) }}</b>\n        </td>\n        <td class= \"text-right\">\n          <b>{{ frappe.format_value(accumulator2.credit, {\"fieldtype\":\"Currency\"}) }}</b>\n        </td>\n      </tr>\n    </table>\n\n    {% set charge = accumulator1.debit - accumulator3.refund %}\n\n    <table class= \"table\">\n      <tr style= \"font-weight: bold\">\n        <td class= \"col-xs-8 text-right\">\n          Total Charge:\n          <br>\n          Total Payment:\n        </td>\n        <td class= \"col-xs-2 text-right\">\n          {{ frappe.format_value(charge, {\"fieldtype\":\"Currency\"}) }}\n          <br>\n        </td>\n        <td class= \"col-xs-2 text-right\">\n          <br>\n          {{ frappe.format_value(accumulator2.credit, {\"fieldtype\":\"Currency\"}) }}\n        </td>\n      </tr>\n      <tr style= \"font-weight: bold\">\n        <td class= \"col-xs-8 text-right\">Total Commission:</td>\n        <td class= \"col-xs-2 text-right\">{{ frappe.format_value(commission.commission, {\"fieldtype\":\"Currency\"}) }} </td>\n        <td class= \"col-xs-2 text-right\"> </td>\n      </tr>\n      <tr style= \"font-weight: bold\">\n        <td class= \"col-xs-8 text-right\">Total Refund:</td>\n        <td class= \"col-xs-2 text-right\">{{ frappe.format_value(accumulator3.refund, {\"fieldtype\":\"Currency\"}) }} </td>\n        <td class= \"col-xs-2 text-right\"> </td>\n      </tr>\n    </table>\n  </div>\n</div>\n\n<div class= \"row\">\n    <div class= \"col-xs-4\">\n\t<table class= \"table text-center\">\n\t\t<tr>\n\t\t<td height=\"190\"></td>\n\t\t</tr>\n            <tr>\n                <td class= \"col-xs-4\" style= \"border-top:none;\"><b>{{ doc.customer_id }}</b></td>\n            </tr>\n            <tr>\n                <td style= \"border-top:1px solid #d1d8dd;\"><b>Customer</b></td>\n            </tr>\n        </table>\n    </div>\n    <div class= \"col-xs-4\">\n    </div>\n    <div class= \"col-xs-4\">\n        <table class= \"table text-center\">\n        <tr>\n            {% set employee = frappe.db.get_value('Employee',{'user_id':frappe.user},'name') %}\n\t\t    <td height=\"190\"><img src=\"{{ frappe.get_doc('Inn Employee Details',{'employee_id': employee}) if employee or '' }}\" alt=\"\" align=\"left\" /></td>\n\t\t</tr>\n\t\t<tr>\n            <td class= \"col-xs-2\" style= \"border-top:none;\"><b>{{ frappe.db.get_value(\"User\", frappe.user,\"full_name\") }}</b></td>\n        </tr>\n        <tr>\n            <td style= \"border-top:1px solid #d1d8dd;\"><b>Staf/Personnel</b></td>\n        </tr>\n        </table>\n    </div>\n</div>",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2025-03-05 14:59:08.346909",
 "modified_by": "Administrator",
 "module": "Inn Hotels",
 "name": "Folio A Commission",
 "owner": "Administrator",
 "page_number": "Hide",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}